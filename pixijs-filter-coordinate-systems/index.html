<!doctype html>
<html lang="zh-Hans">
<head>
  <title>详解 PixiJS Filter 中的参数与坐标系 - PRIN BLOG</title>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="HandheldFriendly" content="True" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
<meta name="generator" content="Hexo" />
<link rel="icon" href="/images/favicon.png" />
  <link rel="canonical" href="https://prinsss.github.io/pixijs-filter-coordinate-systems/"/>
  <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="PRIN BLOG">
  <meta name="keywords" content="前端,WebGL," />

<meta name="description" content="除草啦除草啦，再不更新博客就要变成热带雨林啦！🌿 最近在给一个 PixiJS 程序编写 WebGL Shader，被各种参数和坐标系搞得晕头转向。痛定思痛，整理了一下 PixiJS Filter 系统中的各种概念，以供后续参阅。 在 WebGL 中，我们可以通过编写顶点着色器 (Vertex Shader) 和片元着色器 (Fragment Shader) 来实现各种各样的渲染效果。而在 Pix">
<meta property="og:type" content="article">
<meta property="og:title" content="详解 PixiJS Filter 中的参数与坐标系">
<meta property="og:url" content="https://prinsss.github.io/pixijs-filter-coordinate-systems/index.html">
<meta property="og:site_name" content="PRIN BLOG">
<meta property="og:description" content="除草啦除草啦，再不更新博客就要变成热带雨林啦！🌿 最近在给一个 PixiJS 程序编写 WebGL Shader，被各种参数和坐标系搞得晕头转向。痛定思痛，整理了一下 PixiJS Filter 系统中的各种概念，以供后续参阅。 在 WebGL 中，我们可以通过编写顶点着色器 (Vertex Shader) 和片元着色器 (Fragment Shader) 来实现各种各样的渲染效果。而在 Pix">
<meta property="og:locale">
<meta property="og:image" content="https://prinsss.github.io/pixijs-filter-coordinate-systems/pipeline.png">
<meta property="og:image" content="https://prinsss.github.io/pixijs-filter-coordinate-systems/coordinate-systems.png">
<meta property="og:image" content="https://prinsss.github.io/pixijs-filter-coordinate-systems/spector-js.jpg">
<meta property="article:published_time" content="2023-11-03T13:35:00.000Z">
<meta property="article:modified_time" content="2023-11-03T13:35:00.000Z">
<meta property="article:author" content="prin">
<meta property="article:tag" content="前端">
<meta property="article:tag" content="WebGL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://prinsss.github.io/pixijs-filter-coordinate-systems/pipeline.png">
  <meta name="google-site-verification" content="GRFMvqszPSgldR5B46PfCl67MehNVagYoA9AtJpd8BA" />

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/han-css@3.3.0/dist/han.min.css">
<link rel="stylesheet" href="https://fonts.loli.net/css?family=Fira+Mono|Roboto+Slab:400,600|Noto+Serif+SC:600&display=swap">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@10.6.0/styles/atom-one-dark.min.css" media="screen and (prefers-color-scheme: dark)">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@10.6.0/styles/atom-one-light.min.css" media="screen and (prefers-color-scheme: light)">
<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/node-tikzjax@latest/css/fonts.css" /><style>.tikzjax { display: block; text-align: center; user-select: none; }</style><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>
<body>

<header>
  <div class="container">
    <div class="site-name">
      <a class="logo" href="/">PRIN BLOG</a>
      <span class="description">半吊子全栈开发者的日常</span>
    </div>
  </div>
</header>

<main>
  <div class="container">
    <div class="row">
      <section class="content col-md-8 col-12">
        
  <article>
    <h1 class="post-title">
      <a href="/pixijs-filter-coordinate-systems/">详解 PixiJS Filter 中的参数与坐标系</a>
    </h1>
    <div class="post-meta">
      <span class="post-meta-item post-meta-date">
  <time datetime="2023-11-03T21:35:00+08:00">2023-11-03</time>
</span>

<span class="post-meta-item post-meta-categories">
  <span class="post-meta-item-indicator">Category:</span>
  
    <a class="category-link" href="/categories/tech/">技术</a>
  
</span>

<span class="post-meta-item post-meta-tags">
  
    <a class="tag--link" href="/tag/WebGL/" rel="tag">WebGL</a> <a class="tag--link" href="/tag/%E5%89%8D%E7%AB%AF/" rel="tag">前端</a>
  
</span>


<span class="post-meta-item post-meta-views">
  <span class="pv-counter">loading</span> views
</span>


    </div>

    
      <script src="https://cdn.jsdelivr.net/npm/dayjs@1.10.4/dayjs.min.js"></script>
<script>
  var post_updated = dayjs("2023-11-03T13:35:00.000Z");
  var days_diff_now = dayjs().diff(post_updated, 'days');

  if (days_diff_now > 365) {
    document.write(
      '<div class="post-warning">'+
        '本文最后修订于 '+days_diff_now+' 天前（'+post_updated.format('YYYY-MM-DD')+'），'+
        '其中的信息可能已经有所发展或者不再适用于现阶段。'+
      '</div>'
    );
  }
</script>

    

    
      <div class="post-toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#pixijs-filter-%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">PixiJS Filter 是什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E7%9A%84-filter-%E7%9D%80%E8%89%B2%E5%99%A8%E4%BB%A3%E7%A0%81"><span class="toc-text">默认的 Filter 着色器代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webgl-%E7%9F%A5%E8%AF%86%E5%9B%9E%E9%A1%BE"><span class="toc-text">WebGL 知识回顾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#filter-%E4%B8%AD%E7%9A%84%E5%87%A0%E7%A7%8D%E5%9D%90%E6%A0%87%E7%B3%BB"><span class="toc-text">Filter 中的几种坐标系</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#input-coordinate"><span class="toc-text">Input Coordinate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#screen-coordinate"><span class="toc-text">Screen Coordinate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#filter-coordinate"><span class="toc-text">Filter Coordinate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sprite-texture-coordinate"><span class="toc-text">Sprite Texture Coordinate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sprite-atlas-coordinate"><span class="toc-text">Sprite Atlas Coordinate</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#filter-%E7%9A%84%E8%BE%93%E5%85%A5%E5%8F%82%E6%95%B0"><span class="toc-text">Filter 的输入参数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#avertexposition"><span class="toc-text">aVertexPosition</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#projectionmatrix"><span class="toc-text">projectionMatrix</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#inputsize"><span class="toc-text">inputSize</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#outputframe"><span class="toc-text">outputFrame</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vtexturecoord"><span class="toc-text">vTextureCoord</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#usampler"><span class="toc-text">uSampler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#inputpixel"><span class="toc-text">inputPixel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#inputclamp"><span class="toc-text">inputClamp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resolution"><span class="toc-text">resolution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#filterarea-legacy"><span class="toc-text">filterArea (legacy)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#filterclamp-legacy"><span class="toc-text">filterClamp (legacy)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9D%90%E6%A0%87%E7%B3%BB%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">坐标系之间的转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">注意事项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E9%A1%BE%E9%BB%98%E8%AE%A4%E7%9D%80%E8%89%B2%E5%99%A8%E4%BB%A3%E7%A0%81"><span class="toc-text">回顾默认着色器代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bonus-%E6%8A%95%E5%BD%B1%E7%9F%A9%E9%98%B5"><span class="toc-text">Bonus: 投影矩阵</span></a></li></ol></div>
    

    <div class="post-content"><p>除草啦除草啦，再不更新博客就要变成热带雨林啦！🌿</p>
<p>最近在给一个 PixiJS 程序编写 WebGL Shader，被各种参数和坐标系搞得晕头转向。痛定思痛，整理了一下 PixiJS Filter 系统中的各种概念，以供后续参阅。</p>
<p>在 WebGL 中，我们可以通过编写顶点着色器 (Vertex Shader) 和片元着色器 (Fragment Shader) 来实现各种各样的渲染效果。而在 <a target="_blank" rel="noopener" href="https://pixijs.com/">PixiJS</a> 中，渲染引擎为我们屏蔽了绝大多数的底层实现，通常情况下用户是不需要自己调用 WebGL API 的。如果有编写自定义着色器代码的需求，一般是使用 <a target="_blank" rel="noopener" href="https://pixijs.download/dev/docs/PIXI.Filter.html">Filter</a> 来实现。</p>
<span id="more"></span>
<h2 id="pixijs-filter-是什么"><a href="#pixijs-filter-是什么" class="headerlink" title="PixiJS Filter 是什么"></a>PixiJS Filter 是什么</h2>
<p><code>PIXI.Filter</code> 其实就是一个 WebGL 着色程序，即一组顶点着色器 + 片元着色器的封装。和 Photoshop 中的滤镜功能类似，它接受一个纹理 (Texture) 输入，然后将处理后的内容输出到 Framebuffer 中。使用滤镜，可以实现模糊、扭曲、水波、烟雾等<a target="_blank" rel="noopener" href="https://filters.pixijs.download/main/demo/index.html">高级特效</a>。</p>
<p>用户只需要定义着色器的 GLSL 代码，传入对应的参数，剩下的工作就全部交给 PixiJS 完成。如果你对这些概念不太熟悉，可以看看：<a target="_blank" rel="noopener" href="https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-shaders-and-glsl.html">WebGL 着色器和 GLSL</a>。</p>
<h2 id="默认的-filter-着色器代码"><a href="#默认的-filter-着色器代码" class="headerlink" title="默认的 Filter 着色器代码"></a>默认的 Filter 着色器代码</h2>
<p>在 PixiJS 中，Filter 自带了一组默认的顶点着色器和片元着色器代码。用户在定义 Filter 时，如果省略了其中一个，就会使用默认的着色器代码运行。</p>
<pre class="js"><code>new Filter(undefined, fragShader, myUniforms); // default vertex shader
new Filter(vertShader, undefined, myUniforms); // default fragment shader
new Filter(undefined, undefined, myUniforms);  // both default</code></pre>
<p>这是 Filter 默认的<a target="_blank" rel="noopener" href="https://github.com/pixijs/pixijs/blob/v7.3.2/packages/core/src/filters/defaultFilter.vert">顶点着色器代码</a>：</p>
<pre class="glsl"><code>attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition(void)
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord(void)
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
</code></pre>
<p>这是默认的<a target="_blank" rel="noopener" href="https://github.com/pixijs/pixijs/blob/v7.3.2/packages/core/src/filters/defaultFilter.frag">片元着色器代码</a>：</p>
<pre class="glsl"><code>varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord);
}</code></pre>
<p>看着一脸懵逼不要紧，下面我们逐一解释。</p>
<h2 id="webgl-知识回顾"><a href="#webgl-知识回顾" class="headerlink" title="WebGL 知识回顾"></a>WebGL 知识回顾</h2>
<p>先来复习一下 WebGL <a target="_blank" rel="noopener" href="https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-fundamentals.html">基础知识</a>。</p>
<ul>
<li><strong>WebGL</strong> - 基于 OpenGL ES 的图形渲染 API，可根据代码绘制点、线和三角形</li>
<li><strong>着色器 (Shader)</strong> - 运行在 GPU 上的代码，一种将输入转换为输出的程序</li>
<li><strong>GLSL</strong> - 专门用于编写着色器的语言，语法类似 C 语言</li>
<li><strong>顶点 (Vertex)</strong> - 一个 2D/3D 坐标的数据集合，表示空间中的一个点</li>
<li><strong>顶点着色器 (Vertex Shader)</strong> - 处理顶点数据，生成裁剪空间坐标值</li>
<li><strong>片元 (Fragment)</strong> - 也叫片段，包含了渲染一个像素所需的所有数据</li>
<li><strong>片元着色器 (Fragment Shader)</strong> - 计算当前光栅化的像素的颜色值</li>
<li><strong>参数</strong> - 着色器中获取数据的方法，主要有：attribute、uniform、texture、varying</li>
</ul>
<p><img src="/pixijs-filter-coordinate-systems/pipeline.png" srcset="/images/loading.jpg" data-srcset="/pixijs-filter-coordinate-systems/pipeline.png" alt="pipeline"></p>
<p><em>▲ OpenGL 图形渲染管线的流程。插图来自 <a target="_blank" rel="noopener" href="https://learnopengl.com/Getting-started/Hello-Triangle">LearnOpenGL</a></em></p>
<blockquote>
<p>不太熟悉的同学可能会以为 WebGL 是 3D 渲染 API，但其实 WebGL 本身只是一个光栅化引擎，并没有提供什么 3D 功能。如果想要实现 3D 渲染，你需要将模型中的三维坐标点转换为裁剪空间的二维坐标，并提供对应的颜色。WebGL 负责将这些图元绘制到屏幕上，仅此而已。</p>
<p>试想：任何 3D 模型，不管怎样旋转、缩放、平移，最终展示到你的屏幕上，都是 2D 的。同样，不管模型上有什么贴图、光照、阴影、反射，最终改变的其实都是这个像素的颜色值。</p>
</blockquote>
<p>再来复习一下 WebGL 中的坐标系统：</p>
<ul>
<li><strong>局部坐标 (Local Coordinate)</strong>
<ul>
<li>或称模型坐标，对应局部空间</li>
<li>一个物体中的点相对于该物体原点的局部坐标</li>
</ul></li>
<li><strong>世界坐标 (World Coordinate)</strong>
<ul>
<li>对应世界空间</li>
<li>局部坐标相对于世界原点的坐标，把物体放到整个世界中去看</li>
</ul></li>
<li><strong>观察坐标 (View Coordinate)</strong>
<ul>
<li>对应观察空间</li>
<li>从摄像机/人眼的角度去观察世界，所看到的物体相对于观察者的坐标</li>
<li>同一个世界坐标，从不同的距离、角度、视野去观察，得到的观察坐标也不同</li>
</ul></li>
<li><strong>裁剪坐标 (Clip Coordinate)</strong>
<ul>
<li>对应裁剪空间</li>
<li>将观察空间内超出一定范围的坐标点都裁剪掉，只保留一定范围内的坐标</li>
<li>任何超过这个范围的点都不会显示在你的屏幕上</li>
<li>从观察坐标转换为裁剪坐标的过程，称作投影变换 (Projection)</li>
</ul></li>
<li><strong>标准化设备坐标 (Normalized Device Coordinate, NDC)</strong>
<ul>
<li>将裁剪空间的坐标值范围映射到 <code>[-1, 1]</code> 范围之间，即为 NDC</li>
<li>坐标 <code>(0, 0)</code> 位于裁剪空间的正中间，左下角为 <code>(-1, -1)</code>，右上角为 <code>(1, 1)</code></li>
</ul></li>
<li><strong>屏幕坐标 (Screen Coordinate)</strong>
<ul>
<li>对应屏幕空间</li>
<li>将标准化设备坐标映射到屏幕坐标的过程，称做视口变换</li>
</ul></li>
<li><strong>纹理坐标 (Texture Coordinates)</strong>
<ul>
<li>即纹理图像上的坐标</li>
<li>纹理坐标与像素坐标不同，无论纹理是什么尺寸，纹理坐标范围始终是 <code>[0, 1]</code></li>
<li>纹理图像的左下角坐标为 <code>(0, 0)</code>，右上角坐标为 <code>(1, 1)</code></li>
</ul></li>
</ul>
<p><img src="/pixijs-filter-coordinate-systems/coordinate-systems.png" srcset="/images/loading.jpg" data-srcset="/pixijs-filter-coordinate-systems/coordinate-systems.png" alt="coordinate-systems"></p>
<p><em>▲ 各种坐标与变换矩阵的关系。插图来自 <a target="_blank" rel="noopener" href="https://learnopengl.com/Getting-started/Coordinate-Systems">LearnOpenGL</a></em></p>
<h2 id="filter-中的几种坐标系"><a href="#filter-中的几种坐标系" class="headerlink" title="Filter 中的几种坐标系"></a>Filter 中的几种坐标系</h2>
<p>下面介绍 <a target="_blank" rel="noopener" href="https://github.com/pixijs/pixijs/wiki/v5-Creating-filters">PixiJS Filter 中的坐标系</a>，以及它们和 WebGL 坐标系之间的关系。</p>
<h3 id="input-coordinate"><a href="#input-coordinate" class="headerlink" title="Input Coordinate"></a>Input Coordinate</h3>
<p>输入坐标，用于表示传入 FilterSystem 的纹理上的坐标。</p>
<p>Normalized Input Coordinate 是标准化之后的输入坐标，即<strong>纹理坐标</strong>，范围是 <code>[0, 1]</code>。</p>
<h3 id="screen-coordinate"><a href="#screen-coordinate" class="headerlink" title="Screen Coordinate"></a>Screen Coordinate</h3>
<p>相对于 canvas 视口的<strong>屏幕坐标</strong>，单位是 CSS 像素。</p>
<p>CSS 像素乘以分辨率 <code>resolution</code> 即为屏幕物理像素。</p>
<h3 id="filter-coordinate"><a href="#filter-coordinate" class="headerlink" title="Filter Coordinate"></a>Filter Coordinate</h3>
<p>滤镜坐标，即被 Filter 所覆盖的范围内的<strong>局部坐标</strong>，单位是 CSS 像素。</p>
<p>Normalized Filter Coordinate 是标准化之后的滤镜坐标，滤镜覆盖范围的左上角坐标是 <code>(0, 0)</code>，右下角坐标是 <code>(1, 1)</code>。</p>
<h3 id="sprite-texture-coordinate"><a href="#sprite-texture-coordinate" class="headerlink" title="Sprite Texture Coordinate"></a>Sprite Texture Coordinate</h3>
<p>额外的图片纹理坐标。可以用于采样其他输入中的纹理。</p>
<p><a target="_blank" rel="noopener" href="https://filters.pixijs.download/main/demo/index.html?enabled=DisplacementFilter">Demo: DisplacementFilter</a></p>
<h3 id="sprite-atlas-coordinate"><a href="#sprite-atlas-coordinate" class="headerlink" title="Sprite Atlas Coordinate"></a>Sprite Atlas Coordinate</h3>
<p>额外的精灵图集纹理坐标。</p>
<h2 id="filter-的输入参数"><a href="#filter-的输入参数" class="headerlink" title="Filter 的输入参数"></a>Filter 的输入参数</h2>
<p>讲完坐标的种类，下面介绍 Filter 着色器代码中传入的各个参数（attributes、uniform、varying）分别代表什么，对应的是什么坐标系，以及它们的取值分别是多少。</p>
<blockquote>
<p>⚠️ 以下参数适用于 PixiJS v7 版本，不排除后续版本中有变动的可能。</p>
</blockquote>
<h3 id="avertexposition"><a href="#avertexposition" class="headerlink" title="aVertexPosition"></a>aVertexPosition</h3>
<ul>
<li>类型：<code>vec2</code> 二维向量</li>
<li>含义：Filter 所覆盖的范围内的标准化坐标</li>
<li>坐标系：Normalized Filter Coordinate</li>
<li>取值范围：0.0 ~ 1.0</li>
</ul>
<p>假设有一个长宽为 300x300 的<strong>矩形 A</strong>，其原点左上角位于 (100, 30) 世界坐标处。则有：</p>
<ul>
<li>aVertexPosition <code>(0.0, 0.0)</code> 对应矩形左上角</li>
<li>aVertexPosition <code>(1.0, 1.0)</code> 对应矩形右下角</li>
</ul>
<h3 id="projectionmatrix"><a href="#projectionmatrix" class="headerlink" title="projectionMatrix"></a>projectionMatrix</h3>
<ul>
<li>类型：<code>mat3</code> 3x3 矩阵</li>
<li>含义：投影矩阵，用于将观察空间坐标变换到裁剪空间坐标</li>
</ul>
<p>具体是怎么变换的，请阅读本文底部的「投影矩阵」章节。</p>
<h3 id="inputsize"><a href="#inputsize" class="headerlink" title="inputSize"></a>inputSize</h3>
<ul>
<li>类型：<code>vec4</code> 四维向量</li>
<li>含义：输入 filter 的临时 framebuffer 大小</li>
<li>坐标系：Input Coordinate</li>
<li>取值范围：长宽 &gt; 0，单位 CSS 像素</li>
</ul>
<p>假设有一个大小为 512x512 的 framebuffer，则 inputSize 的值为：</p>
<pre class="glsl"><code>vec4(512, 512, 0.0020, 0.0020)</code></pre>
<p>其中，前两个分量 <code>x, y</code> 为像素大小，后两个分量 <code>z, w</code> 是像素大小的倒数。倒数可用于将除法转换为乘法，因为乘以一个数的倒数等于除以这个数。</p>
<p>以下两个表达式是等价的：</p>
<pre class="glsl"><code>aVertexPosition * (outputFrame.zw * inputSize.zw);

aVertexPosition * (outputFrame.zw / inputSize.xy);</code></pre>
<p>但是在计算机中，乘法比除法的<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/12977050/what-has-a-better-performance-multiplication-or-division">计算速度更快</a>。所以在 GLSL 着色器这类需要高速运行的代码中，通常会尽量<a target="_blank" rel="noopener" href="https://www.khronos.org/opengl/wiki/GLSL_Optimizations">避免直接使用除法</a>，而使用倒数乘法替代。</p>
<h3 id="outputframe"><a href="#outputframe" class="headerlink" title="outputFrame"></a>outputFrame</h3>
<ul>
<li>类型：<code>vec4</code> 四维向量</li>
<li>含义：Filter 所覆盖的区域在屏幕坐标中的位置与大小</li>
<li>坐标系：Screen Coordinate</li>
<li>取值范围：位置不限，长宽 &gt; 0，单位 CSS 像素</li>
</ul>
<p>还是以矩形 A 为例，其 outputFrame 取值为：</p>
<pre class="glsl"><code>vec4(100, 30, 300, 300)</code></pre>
<p>其中，前两个分量 <code>x, y</code> 为输出区域的位置，后两个分量 <code>z, w</code> 为输出区域的长宽。</p>
<h3 id="vtexturecoord"><a href="#vtexturecoord" class="headerlink" title="vTextureCoord"></a>vTextureCoord</h3>
<ul>
<li>类型：<code>vec4</code> 四维向量</li>
<li>含义：用于采样输入 filter 的临时 framebuffer 的纹理坐标</li>
<li>坐标系：Normalized Input Coordinate</li>
<li>取值范围：0.0 ~ 1.0</li>
</ul>
<h3 id="usampler"><a href="#usampler" class="headerlink" title="uSampler"></a>uSampler</h3>
<ul>
<li>类型：<code>sampler2D</code> 纹理</li>
<li>含义：输入 filter 的纹理图像，可配合 vTextureCoord 纹理坐标进行采样</li>
</ul>
<h3 id="inputpixel"><a href="#inputpixel" class="headerlink" title="inputPixel"></a>inputPixel</h3>
<ul>
<li>类型：<code>vec4</code> 四维向量</li>
<li>含义：输入 filter 的临时 framebuffer 物理像素大小</li>
<li>坐标系：Input Coordinate</li>
<li>取值范围：长宽 &gt; 0，单位物理像素</li>
</ul>
<p>和 inputSize 类似，但是单位不是 CSS 像素，而是物理像素。以下两个表达式等价：</p>
<pre class="glsl"><code>inputPixel.xy

inputSize.xy * resolution</code></pre>
<p>同样地，<code>inputPixel.zw</code> 是 <code>inputPixel.xy</code> 的倒数，用于转换除法为乘法。</p>
<h3 id="inputclamp"><a href="#inputclamp" class="headerlink" title="inputClamp"></a>inputClamp</h3>
<ul>
<li>类型：<code>vec4</code> 四维向量</li>
<li>含义：用于将纹理坐标钳制 (clamp) 在 framebuffer 的有效范围内</li>
<li>坐标系：Normalized Input Coordinate</li>
<li>取值范围：0.0 ~ 1.0</li>
</ul>
<p>有效范围指的是临时 framebuffer 中实际包含纹理图像的部分，其余部分可能是透明的（具体原因可阅读文章下方的注意事项）。使用示例：</p>
<pre class="glsl"><code>vec4 color = texture2D(uSampler, clamp(modifiedTextureCoord, inputClamp.xy, inputClamp.zw));</code></pre>
<p>其中，<code>inputClamp.xy</code> 表示有效范围的左上角，<code>inputClamp.zw</code> 表示有效范围的右下角。</p>
<h3 id="resolution"><a href="#resolution" class="headerlink" title="resolution"></a>resolution</h3>
<ul>
<li>类型：<code>float</code></li>
<li>含义：分辨率，即 CSS 像素与物理像素的比率，类似 <code>devicePixelRatio</code></li>
</ul>
<h3 id="filterarea-legacy"><a href="#filterarea-legacy" class="headerlink" title="filterArea (legacy)"></a>filterArea (legacy)</h3>
<ul>
<li>类型：<code>vec4</code> 四维向量</li>
<li>含义：Filter 所覆盖的区域在屏幕坐标中的位置与大小</li>
</ul>
<p>注意，filterArea 已经被标记为 <strong>legacy</strong>，你应该考虑使用其他参数替代。</p>
<pre class="glsl"><code>// 以下语句等价于直接使用 filterArea uniform
vec4 filterArea = vec4(inputSize.xy, outputFrame.xy)</code></pre>
<h3 id="filterclamp-legacy"><a href="#filterclamp-legacy" class="headerlink" title="filterClamp (legacy)"></a>filterClamp (legacy)</h3>
<ul>
<li>类型：<code>vec4</code> 四维向量</li>
<li>含义：兼容旧版本的 <strong>legacy</strong> uniform，与 inputClamp 等价</li>
</ul>
<h2 id="坐标系之间的转换"><a href="#坐标系之间的转换" class="headerlink" title="坐标系之间的转换"></a>坐标系之间的转换</h2>
<p>Filter 中的各种坐标系直接可以通过公式转换。</p>
<p>参考：<a target="_blank" rel="noopener" href="https://github.com/pixijs/pixijs/wiki/v5-Creating-filters">v5 Creating filters · pixijs/pixijs Wiki</a>。</p>
<pre class="js"><code>// Input Coord
// 单位：标准化坐标
vTextureCoord

// Input Coord -&gt; Filter Coord
// 单位：标准化坐标 -&gt; CSS 像素
vTextureCoord * inputSize.xy

// Filter Coord -&gt; Screen Coord
// 单位：CSS 像素
vTextureCoord * inputSize.xy + outputFrame.xy

// Filter Coord -&gt; Normalized Filter Coord
// 单位：CSS 像素 -&gt; 标准化坐标
vTextureCoord * inputSize.xy / outputFrame.zw

// Input Coord -&gt; Physical Filter Coord
// 单位：标准化坐标 -&gt; 物理像素
vTextureCoord * inputPixel.xy

// Filter Coord -&gt; Physical Filter Coord
// 单位：CSS 像素 -&gt; 物理像素
vTextureCoord * inputSize.xy * resolution // 与上一条语句等价</code></pre>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2>
<p>需要注意的是，在应用 Filter 之前，PixiJS 的 <a target="_blank" rel="noopener" href="https://pixijs.download/dev/docs/PIXI.FilterSystem.html">FilterSystem</a> 会先把目标的 DisplayObject 渲染到一个临时的 <a target="_blank" rel="noopener" href="https://pixijs.download/dev/docs/PIXI.Framebuffer.html">Framebuffer</a> 中。</p>
<p>这个 framebuffer 的大小不一定等于 DisplayObject 的大小，它是一个二次幂纹理 (Power-of-two Texture)。假如你有一个 300x300 的图片要应用滤镜，那么 PixiJS 会将其渲染到一个 512x512 尺寸的 framebuffer 上，然后将这个 framebuffer 作为输入传递给着色器代码。</p>
<p>根据这个 DisplayObject 上的 <code>filters</code> 属性定义，PixiJS 会依次执行数组中的 filter，前一个的输出作为后一个的输入，最后一个输出的将渲染到最终的 render target 中。</p>
<p>不过这个创建临时 framebuffer 的行为可能会在自定义着色器代码中导致一些问题，比如纹理坐标的偏移，有时间后续我会另外发文章讨论。</p>
<p><img src="/pixijs-filter-coordinate-systems/spector-js.jpg" srcset="/images/loading.jpg" data-srcset="/pixijs-filter-coordinate-systems/spector-js.jpg" alt="spector-js"></p>
<p><em>▲ 通过 <a target="_blank" rel="noopener" href="https://spector.babylonjs.com/">Spector.js</a> 抓取到的 PixiJS 渲染过程</em></p>
<h2 id="回顾默认着色器代码"><a href="#回顾默认着色器代码" class="headerlink" title="回顾默认着色器代码"></a>回顾默认着色器代码</h2>
<p>好了，梳理完各种坐标系和参数后，我们再来回头看看上面的默认着色器代码：</p>
<pre class="glsl"><code>// 标准化的「滤镜坐标」，范围是 filter 所覆盖的矩形区域
attribute vec2 aVertexPosition;

// 投影矩阵
uniform mat3 projectionMatrix;

// 纹理坐标
varying vec2 vTextureCoord;

// 输入 filter 的临时 framebuffer 大小
uniform vec4 inputSize;

// filter 所覆盖的区域在屏幕坐标中的位置与大小
uniform vec4 outputFrame;

vec4 filterVertexPosition(void)
{
    // position 算出来的是 filter 所覆盖的区域的屏幕坐标
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    // 通过投影矩阵，将屏幕坐标转换为裁剪空间 NDC 坐标
    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord(void)
{
    // 等价于 aVertexPosition * (outputFrame.zw / inputSize.xy)
    // 也就是将「滤镜坐标」从 outputFrame 的范围缩放到 inputSize 的范围
    // 计算出来的就是 inputSize 范围内的「纹理坐标」
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    // 裁剪空间 NDC 坐标传递给 WebGL
    gl_Position = filterVertexPosition();

    // 纹理坐标传递给片元着色器
    vTextureCoord = filterTextureCoord();
}
</code></pre>
<pre class="glsl"><code>// 纹理坐标
varying vec2 vTextureCoord;

// 输入 filter 的临时 framebuffer 纹理
uniform sampler2D uSampler;

void main(void)
{
    // 使用纹理坐标在传入的纹理上采样得到颜色值，传递给 WebGL
    gl_FragColor = texture2D(uSampler, vTextureCoord);
}</code></pre>
<p>怎么样，是不是感觉清晰了很多呢？</p>
<h2 id="bonus-投影矩阵"><a href="#bonus-投影矩阵" class="headerlink" title="Bonus: 投影矩阵"></a>Bonus: 投影矩阵</h2>
<p>如果你很好奇上面的投影矩阵是怎么做到乘一下就能把屏幕坐标转换为裁剪空间坐标的，那么这一小节就可以解答你的疑惑。</p>
<blockquote>
<p>🤫 偷偷告诉你，CSS 中的 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function/matrix"><code>transform: matrix()</code></a> 也是用了同样的矩阵变换原理。</p>
</blockquote>
<p>投影矩阵的默认计算方式如下，代码来自 <a target="_blank" rel="noopener" href="https://github.com/pixijs/pixijs/blob/v7.3.2/packages/core/src/projection/ProjectionSystem.ts#L145">ProjectionSystem#calculateProjection</a>：</p>
<pre class="js"><code>// 矩阵表示：
// | a | c | tx|
// | b | d | ty|
// | 0 | 0 | 1 |
// 数组表示：
// [a, b, 0, c, d, 0, tx, ty, 1]
//
// 主要参数：
// sourceFrame - Filter 所覆盖的区域的世界坐标，长、宽、X、Y，像素单位
// root - 控制 Y 轴反转，当渲染到 framebuffer 时投影为 y-flipped
calculateProjection()
{
    const pm = this.projectionMatrix;
    const sign = !root ? 1 : -1;

    pm.identity();

    pm.a = (1 / sourceFrame.width * 2);
    pm.d = sign * (1 / sourceFrame.height * 2);

    pm.tx = -1 - (sourceFrame.x * pm.a);
    pm.ty = -sign - (sourceFrame.y * pm.d);
}</code></pre>
<p>这个投影矩阵主要做了两件事：</p>
<ol type="1">
<li>缩放变换，从像素坐标转换到 0.x ~ 2.x 范围</li>
<li>平移变换，将坐标转换为 -1.0 ~ 1.0 范围内的标准坐标</li>
</ol>
<p>对于一个长宽为 300x300，原点左上角位于 (100, 30) 世界坐标处的矩形，可得：</p>
<ul>
<li>sourceFrame.width = 300</li>
<li>sourceFrame.height = 300</li>
<li>sourceFrame.x = 100</li>
<li>sourceFrame.y = 30</li>
<li>sign = 1 (此处假设为渲染至 framebuffer)</li>
</ul>
<p>计算出投影矩阵为：</p>
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -3.733ex;" xmlns="http://www.w3.org/2000/svg" width="28.158ex" height="8.597ex" role="img" focusable="false" viewBox="0 -2150 12446 3800"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mrow"><g data-mml-node="mo"><path data-c="23A1" d="M319 -645V1154H666V1070H403V-645H319Z" transform="translate(0,996)"></path><path data-c="23A3" d="M319 -644V1155H403V-560H666V-644H319Z" transform="translate(0,-1006)"></path><svg width="667" height="402" y="49" x="0" viewBox="0 100.5 667 402"><path data-c="23A2" d="M319 0V602H403V0H319Z" transform="scale(1,1.002)"></path></svg></g><g data-mml-node="mtable" transform="translate(667,0)"><g data-mml-node="mtr" transform="translate(0,1400)"><g data-mml-node="mtd"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(778,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1278,0)"></path><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" transform="translate(1778,0)"></path><path data-c="37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z" transform="translate(2278,0)"></path></g></g><g data-mml-node="mtd" transform="translate(4917,0)"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mtd" transform="translate(7556,0)"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)"></path><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" transform="translate(778,0)"></path><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" transform="translate(1278,0)"></path><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" transform="translate(1778,0)"></path><path data-c="37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z" transform="translate(2278,0)"></path></g></g></g><g data-mml-node="mtr"><g data-mml-node="mtd" transform="translate(1139,0)"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mtd" transform="translate(3778,0)"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(778,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1278,0)"></path><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" transform="translate(1778,0)"></path><path data-c="37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z" transform="translate(2278,0)"></path></g></g><g data-mml-node="mtd" transform="translate(7556,0)"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)"></path><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(778,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1278,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1778,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(2278,0)"></path></g></g></g><g data-mml-node="mtr" transform="translate(0,-1400)"><g data-mml-node="mtd" transform="translate(1139,0)"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mtd" transform="translate(4917,0)"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mtd" transform="translate(9084,0)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(11779,0)"><path data-c="23A4" d="M0 1070V1154H347V-645H263V1070H0Z" transform="translate(0,996)"></path><path data-c="23A6" d="M263 -560V1155H347V-644H0V-560H263Z" transform="translate(0,-1006)"></path><svg width="667" height="402" y="49" x="0" viewBox="0 100.5 667 402"><path data-c="23A5" d="M263 0V602H347V0H263Z" transform="scale(1,1.002)"></path></svg></g></g></g></g></svg></mjx-container></span></p>
<!-- ```
| 0.0067 | 0      | -1.6667 |
| 0      | 0.0067 | -1.2000 |
| 0      | 0      | 1       |
``` -->
<p>使用矩阵乘法对世界坐标进行变换：</p>
<!-- NOTE: For display math, use $$ delimiters. (In this case, the delimiters may be separated from the formula by whitespace. However, there can be no blank lines between the opening and closing $$ delimiters.) -->
<p><span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -11.484ex;" xmlns="http://www.w3.org/2000/svg" width="34.862ex" height="24.099ex" role="img" focusable="false" viewBox="0 -5576 15408.9 10652"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtable"><g data-mml-node="mtr" transform="translate(0,3200.5)"><g data-mml-node="mtd"><g data-mml-node="mrow"><g data-mml-node="mo"><path data-c="23A1" d="M319 -645V1154H666V1070H403V-645H319Z" transform="translate(0,1221.5)"></path><path data-c="23A3" d="M319 -644V1155H403V-560H666V-644H319Z" transform="translate(0,-1231.5)"></path><svg width="667" height="853" y="-176.5" x="0" viewBox="0 213.2 667 853"><path data-c="23A2" d="M319 0V602H403V0H319Z" transform="scale(1,2.125)"></path></svg></g><g data-mml-node="mtable" transform="translate(667,0)"><g data-mml-node="mtr" transform="translate(0,1510.6)"><g data-mml-node="mtd"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(573.6,394) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mn" transform="translate(220,-345) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)"></path></g><rect width="1260.7" height="60" x="120" y="220"></rect></g></g><g data-mml-node="mtd" transform="translate(3001,0)"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mtd" transform="translate(5001.3,0)"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mfrac" transform="translate(778,0)"><g data-mml-node="mn" transform="translate(220,394) scale(0.707)"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path></g><g data-mml-node="mn" transform="translate(220,-345) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path></g><rect width="553.6" height="60" x="120" y="220"></rect></g></g></g><g data-mml-node="mtr" transform="translate(0,-114.9)"><g data-mml-node="mtd" transform="translate(500.3,0)"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mtd" transform="translate(2500.7,0)"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(573.6,394) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mn" transform="translate(220,-345) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)"></path></g><rect width="1260.7" height="60" x="120" y="220"></rect></g></g><g data-mml-node="mtd" transform="translate(5001.3,0)"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mfrac" transform="translate(778,0)"><g data-mml-node="mn" transform="translate(220,394) scale(0.707)"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></g><g data-mml-node="mn" transform="translate(220,-345) scale(0.707)"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path></g><rect width="553.6" height="60" x="120" y="220"></rect></g></g></g><g data-mml-node="mtr" transform="translate(0,-1625.5)"><g data-mml-node="mtd" transform="translate(500.3,0)"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mtd" transform="translate(3001,0)"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mtd" transform="translate(5537.1,0)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(7239.9,0)"><path data-c="23A4" d="M0 1070V1154H347V-645H263V1070H0Z" transform="translate(0,1221.5)"></path><path data-c="23A6" d="M263 -560V1155H347V-644H0V-560H263Z" transform="translate(0,-1231.5)"></path><svg width="667" height="853" y="-176.5" x="0" viewBox="0 213.2 667 853"><path data-c="23A5" d="M263 0V602H347V0H263Z" transform="scale(1,2.125)"></path></svg></g></g><g data-mml-node="mo" transform="translate(8129.1,0)"><path data-c="22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z"></path></g><g data-mml-node="mrow" transform="translate(8629.3,0)"><g data-mml-node="mo"><path data-c="23A1" d="M319 -645V1154H666V1070H403V-645H319Z" transform="translate(0,996)"></path><path data-c="23A3" d="M319 -644V1155H403V-560H666V-644H319Z" transform="translate(0,-1006)"></path><svg width="667" height="402" y="49" x="0" viewBox="0 100.5 667 402"><path data-c="23A2" d="M319 0V602H403V0H319Z" transform="scale(1,1.002)"></path></svg></g><g data-mml-node="mtable" transform="translate(667,0)"><g data-mml-node="mtr" transform="translate(0,1400)"><g data-mml-node="mtd"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)"></path></g></g></g><g data-mml-node="mtr"><g data-mml-node="mtd" transform="translate(250,0)"><g data-mml-node="mn"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path></g></g></g><g data-mml-node="mtr" transform="translate(0,-1400)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(2167,0)"><path data-c="23A4" d="M0 1070V1154H347V-645H263V1070H0Z" transform="translate(0,996)"></path><path data-c="23A6" d="M263 -560V1155H347V-644H0V-560H263Z" transform="translate(0,-1006)"></path><svg width="667" height="402" y="49" x="0" viewBox="0 100.5 667 402"><path data-c="23A5" d="M263 0V602H347V0H263Z" transform="scale(1,1.002)"></path></svg></g></g></g><g data-mml-node="mtd" transform="translate(11463.3,0)"><g data-mml-node="mi"></g><g data-mml-node="mo" transform="translate(277.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mrow" transform="translate(1333.6,0)"><g data-mml-node="mo"><path data-c="23A1" d="M319 -645V1154H666V1070H403V-645H319Z" transform="translate(0,996)"></path><path data-c="23A3" d="M319 -644V1155H403V-560H666V-644H319Z" transform="translate(0,-1006)"></path><svg width="667" height="402" y="49" x="0" viewBox="0 100.5 667 402"><path data-c="23A2" d="M319 0V602H403V0H319Z" transform="scale(1,1.002)"></path></svg></g><g data-mml-node="mtable" transform="translate(667,0)"><g data-mml-node="mtr" transform="translate(0,1400)"><g data-mml-node="mtd"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="mtr"><g data-mml-node="mtd"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="mtr" transform="translate(0,-1400)"><g data-mml-node="mtd" transform="translate(389,0)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(1945,0)"><path data-c="23A4" d="M0 1070V1154H347V-645H263V1070H0Z" transform="translate(0,996)"></path><path data-c="23A6" d="M263 -560V1155H347V-644H0V-560H263Z" transform="translate(0,-1006)"></path><svg width="667" height="402" y="49" x="0" viewBox="0 100.5 667 402"><path data-c="23A5" d="M263 0V602H347V0H263Z" transform="scale(1,1.002)"></path></svg></g></g></g></g><g data-mml-node="mtr" transform="translate(0,-275)"><g data-mml-node="mtd" transform="translate(11185.3,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="22EE" d="M78 30Q78 54 95 72T138 90Q162 90 180 74T199 31Q199 6 182 -12T139 -30T96 -13T78 30ZM78 440Q78 464 95 482T138 500Q162 500 180 484T199 441Q199 416 182 398T139 380T96 397T78 440ZM78 840Q78 864 95 882T138 900Q162 900 180 884T199 841Q199 816 182 798T139 780T96 797T78 840Z"></path></g></g></g></g><g data-mml-node="mtr" transform="translate(0,-3200.5)"><g data-mml-node="mtd"><g data-mml-node="mrow"><g data-mml-node="mo"><path data-c="23A1" d="M319 -645V1154H666V1070H403V-645H319Z" transform="translate(0,1221.5)"></path><path data-c="23A3" d="M319 -644V1155H403V-560H666V-644H319Z" transform="translate(0,-1231.5)"></path><svg width="667" height="853" y="-176.5" x="0" viewBox="0 213.2 667 853"><path data-c="23A2" d="M319 0V602H403V0H319Z" transform="scale(1,2.125)"></path></svg></g><g data-mml-node="mtable" transform="translate(667,0)"><g data-mml-node="mtr" transform="translate(0,1510.6)"><g data-mml-node="mtd"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(573.6,394) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mn" transform="translate(220,-345) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)"></path></g><rect width="1260.7" height="60" x="120" y="220"></rect></g></g><g data-mml-node="mtd" transform="translate(3001,0)"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mtd" transform="translate(5001.3,0)"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mfrac" transform="translate(778,0)"><g data-mml-node="mn" transform="translate(220,394) scale(0.707)"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path></g><g data-mml-node="mn" transform="translate(220,-345) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path></g><rect width="553.6" height="60" x="120" y="220"></rect></g></g></g><g data-mml-node="mtr" transform="translate(0,-114.9)"><g data-mml-node="mtd" transform="translate(500.3,0)"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mtd" transform="translate(2500.7,0)"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(573.6,394) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mn" transform="translate(220,-345) scale(0.707)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)"></path></g><rect width="1260.7" height="60" x="120" y="220"></rect></g></g><g data-mml-node="mtd" transform="translate(5001.3,0)"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mfrac" transform="translate(778,0)"><g data-mml-node="mn" transform="translate(220,394) scale(0.707)"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></g><g data-mml-node="mn" transform="translate(220,-345) scale(0.707)"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path></g><rect width="553.6" height="60" x="120" y="220"></rect></g></g></g><g data-mml-node="mtr" transform="translate(0,-1625.5)"><g data-mml-node="mtd" transform="translate(500.3,0)"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mtd" transform="translate(3001,0)"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="mtd" transform="translate(5537.1,0)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(7239.9,0)"><path data-c="23A4" d="M0 1070V1154H347V-645H263V1070H0Z" transform="translate(0,1221.5)"></path><path data-c="23A6" d="M263 -560V1155H347V-644H0V-560H263Z" transform="translate(0,-1231.5)"></path><svg width="667" height="853" y="-176.5" x="0" viewBox="0 213.2 667 853"><path data-c="23A5" d="M263 0V602H347V0H263Z" transform="scale(1,2.125)"></path></svg></g></g><g data-mml-node="mo" transform="translate(8129.1,0)"><path data-c="22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z"></path></g><g data-mml-node="mrow" transform="translate(8629.3,0)"><g data-mml-node="mo"><path data-c="23A1" d="M319 -645V1154H666V1070H403V-645H319Z" transform="translate(0,996)"></path><path data-c="23A3" d="M319 -644V1155H403V-560H666V-644H319Z" transform="translate(0,-1006)"></path><svg width="667" height="402" y="49" x="0" viewBox="0 100.5 667 402"><path data-c="23A2" d="M319 0V602H403V0H319Z" transform="scale(1,1.002)"></path></svg></g><g data-mml-node="mtable" transform="translate(667,0)"><g data-mml-node="mtr" transform="translate(0,1400)"><g data-mml-node="mtd"><g data-mml-node="mn"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)"></path></g></g></g><g data-mml-node="mtr"><g data-mml-node="mtd"><g data-mml-node="mn"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" transform="translate(500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)"></path></g></g></g><g data-mml-node="mtr" transform="translate(0,-1400)"><g data-mml-node="mtd" transform="translate(500,0)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(2167,0)"><path data-c="23A4" d="M0 1070V1154H347V-645H263V1070H0Z" transform="translate(0,996)"></path><path data-c="23A6" d="M263 -560V1155H347V-644H0V-560H263Z" transform="translate(0,-1006)"></path><svg width="667" height="402" y="49" x="0" viewBox="0 100.5 667 402"><path data-c="23A5" d="M263 0V602H347V0H263Z" transform="scale(1,1.002)"></path></svg></g></g></g><g data-mml-node="mtd" transform="translate(11463.3,0)"><g data-mml-node="mi"></g><g data-mml-node="mo" transform="translate(277.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mrow" transform="translate(1333.6,0)"><g data-mml-node="mo"><path data-c="23A1" d="M319 -645V1154H666V1070H403V-645H319Z" transform="translate(0,996)"></path><path data-c="23A3" d="M319 -644V1155H403V-560H666V-644H319Z" transform="translate(0,-1006)"></path><svg width="667" height="402" y="49" x="0" viewBox="0 100.5 667 402"><path data-c="23A2" d="M319 0V602H403V0H319Z" transform="scale(1,1.002)"></path></svg></g><g data-mml-node="mtable" transform="translate(667,0)"><g data-mml-node="mtr" transform="translate(0,1400)"><g data-mml-node="mtd"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="mtr"><g data-mml-node="mtd"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="mtr" transform="translate(0,-1400)"><g data-mml-node="mtd"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(1167,0)"><path data-c="23A4" d="M0 1070V1154H347V-645H263V1070H0Z" transform="translate(0,996)"></path><path data-c="23A6" d="M263 -560V1155H347V-644H0V-560H263Z" transform="translate(0,-1006)"></path><svg width="667" height="402" y="49" x="0" viewBox="0 100.5 667 402"><path data-c="23A5" d="M263 0V602H347V0H263Z" transform="scale(1,1.002)"></path></svg></g></g></g></g></g></g></g></svg></mjx-container></span></p>
<p>得到如下坐标：</p>
<ul>
<li>局部坐标：(0, 0) ~ (300, 300)</li>
<li>世界坐标：(100, 30) ~ (400, 330)</li>
<li>缩放变换：(0.67, 0.20) ~ (2.68, 2.21)</li>
<li>平移变换：(-1.0, -1.0) ~ (1.0, 1.0)</li>
</ul>
<p>即可将世界坐标转换为裁剪空间的标准化设备坐标。数学，很神奇吧！👊</p>
<p>更多关于矩阵变换的资料可参考：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-2d-matrices.html">WebGL 二维矩阵 - WebGL Fundamentals</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/WebGL_API/Matrix_math_for_the_web">Matrix math for the web - MDN</a></li>
<li><a target="_blank" rel="noopener" href="https://www.shuxuele.com/algebra/matrix-multiplying.html">矩阵乘法 - 数学乐</a></li>
</ul>
<hr>
<blockquote>
<p>顺便测试一下我的新插件 <a target="_blank" rel="noopener" href="https://github.com/prinsss/hexo-filter-tikzjax">hexo-filter-tikzjax</a>，别在意～</p>
</blockquote>
<p><span class="tikzjax"><svg xmlns="http://www.w3.org/2000/svg" width="312.264" height="169.981" viewBox="-72 -72 234.198 127.485"><g stroke="#000" stroke-linejoin="round" stroke-miterlimit="10" stroke-width=".4"><path fill="#ccf" fill-opacity=".8" d="m-19.28-32.465-11.012 46.634 25.266-6.175 2.59-44.585ZM-2.436-36.591l-2.59 44.585 29.847 2.163-7.369-45.297ZM17.452-35.14l7.37 45.297 16.9 9.218-12.974-48.37Z"/><path fill="#ccf" fill-opacity=".8" d="M-23.207-25.21-36.18 25.066l5.89-10.897 11.01-46.634Z"/><path fill="none" d="m44.34 19.176 7.767-.569M49.519-30.042v48.389"/><path fill="none" stroke-linecap="round" stroke-width=".32" d="M47.919-28.842c.6-.1 1.5-1.2 1.6-1.5.1.3 1 1.4 1.6 1.5M51.118 17.147c-.6.1-1.5 1.2-1.6 1.5-.1-.3-1-1.4-1.6-1.5"/><path fill="#ccf" fill-opacity=".8" d="m28.748-28.994 12.974 48.37-5.89 10.897-11.01-52.012Z"/><path fill="none" d="M10.567 36.447 2.77 22.221v-80.915"/><path fill="none" stroke-linecap="round" stroke-width=".32" d="M1.17-57.494c.6-.1 1.5-1.2 1.6-1.5.1.3 1 1.4 1.6 1.5"/><path fill="none" d="m2.77 22.22-38.951 2.846M-36.181 25.066l-20.34 1.475"/><path fill="none" stroke-linecap="round" stroke-width=".31998719999999997" d="M-55.21 28.05c-.142-.591-1.304-1.41-1.61-1.488.291-.121 1.323-1.098 1.38-1.704"/><path fill="#ccf" fill-opacity=".8" d="m-11.911-19.036-7.37 53.32-16.9-9.218 12.974-50.276Z"/><path fill="none" d="M-36.181 20.144V-56.31M31.337-29.194l20.77-1.507"/><path fill="#ccf" fill-opacity=".8" d="m24.821-21.739 11.012 52.012-25.266 6.174-2.59-54.06Z"/><path fill="none" d="m2.312-44.325-25.06 1.84"/><path fill="none" stroke-linecap="round" stroke-width=".319984" d="M.998-45.833c.144.591 1.306 1.408 1.613 1.486-.292.122-1.323 1.1-1.379 1.706M-21.434-40.978c-.144-.591-1.307-1.408-1.613-1.486.292-.122 1.323-1.1 1.379-1.705"/><path fill="none" d="M-23.207-30.132v-17.271M2.312-54.198l-38.035 2.778"/><path fill="none" stroke-linecap="round" stroke-width=".31998719999999997" d="M.999-55.706c.143.59 1.305 1.408 1.612 1.486-.292.122-1.323 1.1-1.38 1.705M-34.41-49.912c-.143-.591-1.305-1.408-1.612-1.486.292-.122 1.324-1.1 1.38-1.705"/><path fill="#ccf" fill-opacity=".8" d="m7.977-17.613 2.59 54.06-29.847-2.162 7.369-53.32Z"/><path fill="none" d="m14.5 43.64-3.933-7.193"/><path fill="none" stroke-linecap="round" stroke-width=".319984" d="M15.328 41.82c-.478.376-.74 1.772-.684 2.084-.232-.216-1.55-.749-2.124-.549"/><g fill="#fff"><path stroke="none" d="M-15.205-40.142h10.002v-6.556h-10.002Z"/><g fill="#000" stroke="none"><text x="2.771" y="22.221" font-family="cmmi8" font-size="8" transform="translate(-16.975 -64.474)">r</text><text x="6.606" y="23.332" font-family="cmr6" font-size="6" transform="translate(-16.975 -64.474)">0</text></g></g><g fill="#fff"><path stroke="none" d="M-21.72-49.531h10.002v-6.556h-10.003Z"/><g fill="#000" stroke="none"><text x="2.771" y="22.221" font-family="cmmi8" font-size="8" transform="translate(-23.491 -73.863)">r</text><text x="6.606" y="23.332" font-family="cmr6" font-size="6" transform="translate(-23.491 -73.863)">1</text></g></g><g fill="#fff"><path stroke="none" d="M46.07-2.084h6.898V-9.64h-6.899Z"/><text x="2.771" y="22.221" fill="#000" stroke="none" font-family="cmmi8" font-size="8" transform="translate(44.299 -25.305)">h</text></g><text x="2.771" y="22.221" stroke="none" font-family="cmmi10" font-size="10" transform="translate(9.092 29.662)">x</text><text x="2.771" y="22.221" stroke="none" font-family="cmmi10" font-size="10" transform="translate(-2.63 -86.852)">y</text><text x="2.771" y="22.221" stroke="none" font-family="cmmi10" font-size="10" transform="translate(-68.374 6.506)">z</text><path fill="#fff" stroke="gray" d="M80.304-32.465 69.293 14.169l25.266-6.175 2.59-44.585Z"/><path fill="#fff" stroke="gray" d="M97.148-36.591 94.56 7.994l29.847 2.163-7.37-45.297Z"/><path fill="#fff" stroke="gray" d="m117.037-35.14 7.369 45.297 16.901 9.218-12.975-48.37ZM76.378-25.21 63.403 25.066l5.89-10.897 11.011-46.634Z"/><path fill="#fff" stroke="gray" d="m128.332-28.994 12.975 48.37-5.89 10.897-11.011-52.012ZM87.673-19.036l-7.369 53.32-16.9-9.218L76.377-25.21Z"/><path fill="#fff" stroke="gray" d="m124.406-21.739 11.011 52.012-25.266 6.174-2.59-54.06Z"/><path fill="red" fill-opacity=".5" d="m87.673-19.036-7.369 53.32 29.847 2.163-2.59-54.06Z"/><path stroke="none" d="M82.304 34.285a2 2 0 1 0-4 0 2 2 0 0 0 4 0M112.151 36.447a2 2 0 1 0-4 0 2 2 0 0 0 4 0M89.673-19.036a2 2 0 1 0-4 0 2 2 0 0 0 4 0M109.562-17.613a2 2 0 1 0-4 0 2 2 0 0 0 4 0m-2 0"/><g stroke="none" font-size="8"><text x="2.771" y="22.221" font-family="cmmi8" transform="translate(129.095 -48.57)">i</text><text x="5.664" y="22.221" font-family="cmr8" transform="translate(129.095 -48.57)">=</text><text x="12.276" y="22.221" font-family="cmr8" transform="translate(129.095 -48.57)">0</text></g><g stroke="none" font-size="8"><text x="2.771" y="22.221" font-family="cmmi8" transform="translate(142.07 -.201)">i</text><text x="5.664" y="22.221" font-family="cmr8" transform="translate(142.07 -.201)">=</text><text x="12.276" y="22.221" font-family="cmr8" transform="translate(142.07 -.201)">1</text></g><text x="2.771" y="22.221" stroke="none" font-family="cmmi8" font-size="8" transform="translate(73.801 -12.73)">j</text><g stroke="none" font-size="8"><text x="2.771" y="22.221" font-family="cmmi8" transform="translate(109.605 -10.937)">j</text><text x="6.669" y="22.221" font-family="cmr8" transform="translate(109.605 -10.937)">+</text><text x="13.28" y="22.221" font-family="cmr8" transform="translate(109.605 -10.937)">1</text></g><path fill="none" d="M99.965 14.667c3.402-2.554 4.568-8.21 2.604-12.632-1.964-4.423-6.315-5.938-9.717-3.385s-4.568 8.21-2.604 12.632c.624 1.406 1.523 2.574 2.236 3.109"/><path fill="none" stroke-linecap="round" stroke-width=".3199904" d="M92.485 12.39c-.28.54.06 1.92.239 2.18-.3-.1-1.72-.04-2.16.38"/><path stroke="none" d="M110.152 36.447"/><g stroke="none"><text x="2.771" y="22.221" font-family="cmmi8" font-size="8" transform="translate(78.292 -45.9)">P</text><text x="8.159" y="23.332" font-family="cmr6" font-size="6" transform="translate(78.292 -45.9)">00</text></g><g stroke="none"><text x="2.771" y="22.221" font-family="cmmi8" font-size="8" transform="translate(70.923 21.063)">P</text><text x="8.159" y="23.332" font-family="cmr6" font-size="6" transform="translate(70.923 21.063)">10</text></g><g stroke="none"><text x="2.771" y="22.221" font-family="cmmi8" font-size="8" transform="translate(98.18 -44.478)">P</text><text x="8.159" y="23.332" font-family="cmr6" font-size="6" transform="translate(98.18 -44.478)">01</text></g><g stroke="none"><text x="2.771" y="22.221" font-family="cmmi8" font-size="8" transform="translate(100.77 23.226)">P</text><text x="8.159" y="23.332" font-family="cmr6" font-size="6" transform="translate(100.77 23.226)">11</text></g></g></svg></span></p>
</div>
    <div class="post-copyright"><p>除另有声明外，本博客文章均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by/4.0/">知识共享(Creative Commons) 署名 4.0 国际许可协议</a> 进行许可。转载请注明原作者与文章出处。</p></div>
  </article>

  
    <nav class="post-nav">
      
      <div class="post-nav-item post-nav-prev">上一篇：
        <a href="/graphics-with-tikz-in-hexo/">使用 TikZ 在 Hexo 博客中愉快地画图</a>
      </div>
      
      
      <div class="post-nav-item post-nav-next">下一篇：
        <a href="/hacking-pdd-ble-switch/">逆向拼多多上的「关灯神器」，实现蓝牙遥控开关灯</a>
      </div>
      
    </nav>
  

  
    


<script src="https://giscus.app/client.js"
  data-repo="prinsss/prinsss.github.io"
  data-repo-id="MDEwOlJlcG9zaXRvcnkxMDU3MzY5MTA="
  data-category="Announcements"
  data-category-id="DIC_kwDOBk1qzs4CawFb"
  data-mapping="title"
  data-strict="1"
  data-reactions-enabled="1"
  data-emit-metadata="0"
  data-input-position="top"
  data-theme="preferred_color_scheme"
  data-lang="zh-CN"
  data-loading="lazy"
  crossorigin="anonymous"
  async>
</script>


  

      </section>
      <aside class="sidebar col-md-3 offset-md-1 col-12">
        
  
  <section class="widget widget-toc">
    <h3 class="widget-title">文章目录</h3>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#pixijs-filter-%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">PixiJS Filter 是什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E7%9A%84-filter-%E7%9D%80%E8%89%B2%E5%99%A8%E4%BB%A3%E7%A0%81"><span class="toc-text">默认的 Filter 着色器代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webgl-%E7%9F%A5%E8%AF%86%E5%9B%9E%E9%A1%BE"><span class="toc-text">WebGL 知识回顾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#filter-%E4%B8%AD%E7%9A%84%E5%87%A0%E7%A7%8D%E5%9D%90%E6%A0%87%E7%B3%BB"><span class="toc-text">Filter 中的几种坐标系</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#input-coordinate"><span class="toc-text">Input Coordinate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#screen-coordinate"><span class="toc-text">Screen Coordinate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#filter-coordinate"><span class="toc-text">Filter Coordinate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sprite-texture-coordinate"><span class="toc-text">Sprite Texture Coordinate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sprite-atlas-coordinate"><span class="toc-text">Sprite Atlas Coordinate</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#filter-%E7%9A%84%E8%BE%93%E5%85%A5%E5%8F%82%E6%95%B0"><span class="toc-text">Filter 的输入参数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#avertexposition"><span class="toc-text">aVertexPosition</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#projectionmatrix"><span class="toc-text">projectionMatrix</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#inputsize"><span class="toc-text">inputSize</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#outputframe"><span class="toc-text">outputFrame</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vtexturecoord"><span class="toc-text">vTextureCoord</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#usampler"><span class="toc-text">uSampler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#inputpixel"><span class="toc-text">inputPixel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#inputclamp"><span class="toc-text">inputClamp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resolution"><span class="toc-text">resolution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#filterarea-legacy"><span class="toc-text">filterArea (legacy)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#filterclamp-legacy"><span class="toc-text">filterClamp (legacy)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9D%90%E6%A0%87%E7%B3%BB%E4%B9%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">坐标系之间的转换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">注意事项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E9%A1%BE%E9%BB%98%E8%AE%A4%E7%9D%80%E8%89%B2%E5%99%A8%E4%BB%A3%E7%A0%81"><span class="toc-text">回顾默认着色器代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bonus-%E6%8A%95%E5%BD%B1%E7%9F%A9%E9%98%B5"><span class="toc-text">Bonus: 投影矩阵</span></a></li></ol>
  </section>
  

        


<section class="widget" id="widget-categories">
  <h3 class="widget-title">分类</h3>
  
  
    <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/tech/">技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/diary/">日常</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/essay/">随笔</a></li></ul>
  
</section>



<section class="widget" id="widget-pages">
  <h3 class="widget-title">页面</h3>
  <ul class="menu">
    
      
      <li class="menu-item menu-item-archives">
        <a href="/archives/" title="">归档</a>
      </li>
    
      
      <li class="menu-item menu-item-about">
        <a href="/about/" title="">关于我</a>
      </li>
    
      
      <li class="menu-item menu-item-friends">
        <a href="/friends/" title="">朋友们</a>
      </li>
    
  </ul>
</section>



<section class="widget" id="widget-links">
  <h3 class="widget-title">链接</h3>
  <ul class="menu">
    
      
      <li class="menu-item menu-item-github">
        <a href="https://github.com/prinsss" title="" target="_blank">GitHub</a>
      </li>
    
      
      <li class="menu-item menu-item-rss">
        <a href="/atom.xml" title="" target="_blank">RSS Feed</a>
      </li>
    
  </ul>
</section>




      </aside>
    </div>
  </div>
</main>

<footer>
  
  <div class="container">
    <p>
      &copy; 2024 <a href="https://prinsss.github.io">PRIN BLOG</a>. Proudly published with
      <a href="https://hexo.io/" target="_blank">Hexo</a> & <a href="https://github.com/printempw/hexo-theme-murasaki/" target="_blank">Murasaki</a>.
    </p>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/han-css@3.3.0/dist/han.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@10.6.0/highlight.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.3.1/dist/lazyload.min.js"></script>
<script>
  hljs.initHighlightingOnLoad();
  Han(document.querySelector('section.content')).setRoutine([
    'initCond', 'renderElem', 'renderJiya', 'correctBasicBD', 'substCombLigaWithPUA'
    // 'renderHanging', 'renderHWS'
  ]).render();
  new LazyLoad({
    elements_selector: '.post-content img',
    callback_loaded: function (el) {
      el.parentNode.nodeName.toLowerCase() === 'a' || mediumZoom(el, { margin: 24 });
    }
  });
</script>
  <script async src="https://oishii.prin.studio/delicious-party"
    data-website-id="02075562-9733-4917-8c28-be13173bb1f7">
  </script>

</body>
</html>
